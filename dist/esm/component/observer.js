import proxy from"../proxy.js";import events from"./hooks.js";import propsListener from"./helpers/props-listener.js";import manipulate from"./helpers/manipulate.js";function runUpdate(e,r){events.callUpdate(e,r),propsListener(e,r),e.render(void 0,r)}function create(e){let r=!1;e._props&&e._props.__isProxy&&(proxy.remove(e._props),r=!0),e._props=proxy.create(e._rawProps,!0,(r=>{e._isRendered&&(e.delayUpdate?setTimeout((()=>{runUpdate(e,r)}),e.delayUpdate):runUpdate(e,r))}),((r,p)=>{r[p]=manipulate(e,r[p],p)})),proxy.manipulate(e._props,((r,p,o)=>manipulate(e,r,p,o))),proxy.beforeChange(e._props,(r=>{if(!1===events.callBeforeUpdate(e,r))return!1})),r&&e._isRendered&&e.render()}export{create};export default{create:create};